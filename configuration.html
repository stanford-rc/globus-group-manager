<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration &mdash; Stanford Globus Group Manager  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Stanford Globus Group Manager
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#virtualenv">Virtualenv</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#required-variables">Required Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optional-variables">Optional Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hard-coded-variables">Hard-Coded Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#value-formats">Value Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#env-file">.env File</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stanford Globus Group Manager</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/configuration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline"></a></h1>
<p>Core configuration is provided through environment variables.  This section
describes the environment variables which must be populated, and how the data
may be stored or accessed.</p>
<section id="required-variables">
<h2>Required Variables<a class="headerlink" href="#required-variables" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">WORKGROUP_STEM</span></code>: This is the name of the Workgroup stem that will be used to
hold SGGM-created Workgroups.  The trailing colon must <em>not</em> be present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WORKGROUP_API_TIER</span></code>: The tier to use for the Workgroups API.  This can
either be ‘PROD’ or ‘UAT’.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WORKGROUP_API_KEY</span></code>: The private key used to connect to the Workgroups API.
This key needs to be PEM-encoded, with no encryption passphrase.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WORKGROUP_API_CERT</span></code>: The certificate—matching the private key set in
<code class="docutils literal notranslate"><span class="pre">WORKGROUP_API_KEY</span></code>—to use for authenticating to the Workgroups API.  It
must also be PEM-encoded.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GLOBUS_CLIENT_ID</span></code>: The ID of the Globus Auth Confidential Client used by
this application.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GLOBUS_CLIENT_SECRET</span></code>: A Client Secret for the Globus Auth Confidential
Client.</p></li>
</ul>
</section>
<section id="optional-variables">
<h2>Optional Variables<a class="headerlink" href="#optional-variables" title="Permalink to this headline"></a></h2>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">GLOBUS_PREFIX</span></code>: If present, this string will be included in created Globus
Group names, and in Workgroup descriptions.  It is meant to denote
non-production, so the convention is to leave this variable un-set in the
producton environment.</p>
<p>If set, the value will be uppercased and placed in square brackets at the
start of the Globus Group’s name, in the format “[$prefix] …”.  In the
Workgroup, it will be lowercased and placed at the start of the Workgroup
description in the format “$prefix environment—“.</p>
</li>
</ul>
</section>
<section id="hard-coded-variables">
<h2>Hard-Coded Variables<a class="headerlink" href="#hard-coded-variables" title="Permalink to this headline"></a></h2>
<p>Some settings are hard-coded, because it is very unlikely that they will
change.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">APPS_DOMAIN</span></code>: All Globus Identity usernames take the form of
<code class="docutils literal notranslate"><span class="pre">user&#64;domain</span></code>.  Every Globus Auth Confidential Client has its own Globus
Identity, in a common domain.  This setting holds that common domain.  Right
now it is <code class="docutils literal notranslate"><span class="pre">clients.auth.globus.org</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DOMAIN</span></code>: Every Stanford person has a Globus Identity in a common domain.
This setting holds that domain.  Right now it is <code class="docutils literal notranslate"><span class="pre">stanford.edu</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stanford people who log in to Globus via Google will have an Identity username of the form <code class="docutils literal notranslate"><span class="pre">sunetid&#64;stanford.edu&#64;accounts.google.com</span></code>.  This setting does not recognize those Globus Identities as Stanford people, so clients will need to take care to check that users are logging in via “Stanford University”, not via SAML.</p>
</div>
</li>
</ul>
</section>
<section id="value-formats">
<h2>Value Formats<a class="headerlink" href="#value-formats" title="Permalink to this headline"></a></h2>
<p>For some environment variables, it is not safe storing the actual value in the
environment variable.  For this reason, all values are first parsed through
Python’s <code class="docutils literal notranslate"><span class="pre">urlparse</span></code> function.  If a recognized scheme is found, the value of
the environment variable is taken as a URL to find the variable’s <em>actual</em>
value.</p>
<p>The following schemes are recognized:</p>
<ul>
<li><p><strong>Files</strong>: If the scheme is <code class="docutils literal notranslate"><span class="pre">file</span></code>, the value is taken as a path to a file.</p>
<p>The format is <code class="docutils literal notranslate"><span class="pre">file:path</span></code> for paths relative to the current working
directory, and <code class="docutils literal notranslate"><span class="pre">file:/path</span></code> for absolute paths.</p>
</li>
<li><p><strong>Google Cloud Secrets</strong>: If the scheme is <code class="docutils literal notranslate"><span class="pre">gcs</span></code>, the value is taken from a
Secret in Google Cloud Secret Manger.</p>
<p>The format is <code class="docutils literal notranslate"><span class="pre">gcs://project/name?version</span></code>.  All three components are
required, but you can use the special string “latest” to refer to the latest
version of a specific Secret.</p>
<p>This required that SGGM is built with the <code class="docutils literal notranslate"><span class="pre">gcs</span></code> option.</p>
</li>
</ul>
</section>
<section id="env-file">
<h2>.env File<a class="headerlink" href="#env-file" title="Permalink to this headline"></a></h2>
<p>In local installations, it is possible to put configuration into a local file,
named <code class="docutils literal notranslate"><span class="pre">.env</span></code>.  That file should be placed in the project’s root directory
(whatever that means for your installation).</p>
<p>Here is an example dotenv file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">GLOBUS_PREFIX</span><span class="o">=</span><span class="s">DEV</span><span class="w"></span>
<span class="na">GLOBUS_CLIENT_ID</span><span class="o">=</span><span class="s">67a9fc42-cbe6-11ec-9a66-bb2cbd847dfd</span><span class="w"></span>
<span class="na">GLOBUS_CLIENT_SECRET</span><span class="o">=</span><span class="s">gcs://myproject/globus?latest</span><span class="w"></span>

<span class="na">WORKGROUP_STEM</span><span class="o">=</span><span class="s">globus</span><span class="w"></span>
<span class="na">WORKGROUP_API_TIER</span><span class="o">=</span><span class="s">UAT</span><span class="w"></span>
<span class="na">WORKGROUP_API_CERT</span><span class="o">=</span><span class="s">file:workgroup.pem</span><span class="w"></span>
<span class="na">WORKGROUP_API_KEY</span><span class="o">=</span><span class="s">gcs://myproject/workgroup?latest</span><span class="w"></span>
</pre></div>
</div>
<p>The contents of the “dotenv” file are read when the program is first started,
and will be overridden by variables that are set in the actual environment.  In
other words, if your dotenv file sets <code class="docutils literal notranslate"><span class="pre">GLOBUS_PREFIX</span></code> to “a”, and the OS
environment sets it to “b”, the actual value used will be “b”.</p>
<p>Both the dotenv file and the OS environment are read at program start only, so
a full program restart is needed in order to pick up changes.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, The Board of Trustees of the Leland Stanford Junior University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>